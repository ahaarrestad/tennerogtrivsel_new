---
import TelefonKnapp from "./TelefonKnapp.astro";
import EpostKnapp from "./EpostKnapp.astro";
import { getSiteSettings } from '../scripts/getSettings';
import KontaktKnapp from "./KontaktKnapp.astro";

const settings = await getSiteSettings();
---
<section id="forside" class="section-container bg-white !pt-8 md:!pt-12">
    <div class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-16">

            <div class="space-y-8 order-1">
                <h1 class="section-heading !text-left !text-4xl md:!text-6xl !mx-0">
                    {settings.velkomstTittel1}<br/>
                    <span class="text-blue-600">{settings.velkomstTittel2}</span>
                </h1>

                <p class="section-intro !mx-0 !text-left">
                    {settings.velkomstTekst}
                </p>

                <div class="hidden lg:flex flex-row gap-4 pt-4">
                    <TelefonKnapp/>
                    <EpostKnapp/>
                    <KontaktKnapp/>
                </div>
            </div>

            <div class="order-2 relative">
                <div class="absolute -inset-4 bg-blue-50 rounded-[40px] rotate-2 -z-10"></div>
                <div class="rounded-3xl shadow-2xl overflow-hidden aspect-[16/10] border border-slate-100 bg-blue-50">
                    <img src="/hovedbilde.png" alt="Tenner og Trivsel" class="w-full h-full object-cover object-center"/>
                </div>
            </div>

            <div class="order-3 lg:hidden flex flex-col sm:flex-row gap-4">
                <TelefonKnapp/>
                <EpostKnapp/>
                <KontaktKnapp/>
            </div>
        </div>

        <div id="dynamic-message-box" class="hidden card-base !bg-slate-900 border-none shadow-xl mt-8 order-4">
            <h3 id="dynamic-title" class="card-title !text-blue-400 mb-4"></h3>
            <div id="dynamic-content" class="card-text !text-slate-300 whitespace-pre-wrap prose prose-invert max-w-none"></div>
        </div>
    </div>

    <script>
        import { getActiveMessage } from '../scripts/messageClient.js';

        async function updateHeroMessage() {
            const active = await getActiveMessage();
            const box = document.getElementById('dynamic-message-box');
            const title = document.getElementById('dynamic-title');
            const content = document.getElementById('dynamic-content');

            if (active && box && title && content) {
                title.textContent = active.title;
                content.innerHTML = active.htmlContent;
                box.classList.remove('hidden');
            } else if (box) {
                box.classList.add('hidden');
            }
        }

        document.addEventListener('astro:page-load', updateHeroMessage);
        updateHeroMessage();
    </script>
</section>