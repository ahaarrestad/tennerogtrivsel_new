---
import TelefonKnapp from "./TelefonKnapp.astro";
import EpostKnapp from "./EpostKnapp.astro";
import {getSiteSettings} from '../scripts/getSettings';
import KontaktKnapp from "./KontaktKnapp.astro";

import {Image} from 'astro:assets';
import hovedBilde from '../assets/hovedbilde.png'; // Importer bildefilen direkte

const settings = await getSiteSettings();
---
<section id="forside" class="section-container bg-white pt-8! md:pt-12! scroll-mt-20 md:scroll-mt-28">
    <div class="section-content">
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center mb-16">

            <div class="space-y-8 order-1">
                <h1 class="section-heading text-center lg:text-left text-4xl! md:text-6xl! mx-0!">
                    {settings.velkomstTittel1}<br/>
                    <span class="text-brand">{settings.velkomstTittel2}</span>
                </h1>

                <p class="section-intro text-center lg:text-left mx-0! max-w-2xl lg:ml-0">
                    {settings.velkomstTekst}
                </p>

                <div class="hidden lg:flex flex-row flex-wrap gap-4 pt-4">
                    <TelefonKnapp/>
                    <EpostKnapp/>
                    <KontaktKnapp/>
                </div>
            </div>

            <div class="order-2 relative z-0 mb-8 lg:mb-0">
                <div class="rounded-2xl border-4 border-white shadow-md overflow-hidden aspect-[16/10] bg-white">
                    <Image
                            src={hovedBilde}
                            alt="Tenner og Trivsel"
                            class="w-full h-full object-cover object-center"
                            loading="eager"
                            fetchpriority="high"
                    />
                </div>
            </div>

            <div class="order-3 lg:hidden flex flex-wrap gap-4 justify-center md:justify-start w-full mt-4">
                <TelefonKnapp/>
                <EpostKnapp/>
                <KontaktKnapp/>
            </div>

            <div id="dynamic-message-box"
                 class="hidden card-base bg-slate-300! border-none shadow-xl mt-8 order-4 lg:col-span-2">
                <h3 id="dynamic-title" class="card-title text-brand! mb-4"></h3>
                <div id="dynamic-content"
                     class="card-text text-brand! whitespace-pre-wrap prose prose-invert max-w-none">
                </div>
            </div>
        </div>
    </div>
    <script>
        import {getActiveMessage} from '../scripts/messageClient.js';

        async function updateHeroMessage() {
            const active = await getActiveMessage();
            const box = document.getElementById('dynamic-message-box');
            const title = document.getElementById('dynamic-title');
            const content = document.getElementById('dynamic-content');

            if (active && box && title && content) {
                title.textContent = active.title;
                content.innerHTML = active.htmlContent;
                box.classList.remove('hidden');
            } else if (box) {
                box.classList.add('hidden');
            }
        }

        document.addEventListener('astro:page-load', updateHeroMessage);
        updateHeroMessage();
    </script>
</section>