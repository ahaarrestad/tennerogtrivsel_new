---
// src/components/Card.astro
interface Props {
    title: string;
    index?: number | string;
    href?: string | null;
    headerOffset?: string;
    minHeight?: string;
    centered?: boolean;
    isStack?: boolean;
    image?: boolean;
    external?: boolean;
}

const {
    index = 0,
    title,
    href = null,
    headerOffset = "200px",
    minHeight = "auto",
    centered = true,
    isStack = true,
    image = false,
    external = false
} = Astro.props;

const Tag = href ? 'a' : 'div';

// Samle alle inline-stiler på ett sted for en renere mal
const cardStyles = {
    minHeight,
    ...(isStack && {
        '--card-index': index,
        '--header-offset': headerOffset
    })
};
---

<Tag
        href={href}
        target={external ? "_blank" : undefined}
        rel={external ? "noopener noreferrer" : undefined}
        style={cardStyles}
        class:list={[
            "card-base group no-underline text-inherit flex flex-col w-full",
            {
                "cursor-pointer": href,
                "stack-card": isStack,
                "relative h-full": !isStack,
                "items-center text-center justify-center": centered,
                "items-start text-left": !centered
            }
        ]}
>
    <div class="card-accent-corner"></div>

    <div class:list={[
        "relative z-10 mb-6 empty:hidden",
        image ? "w-48 h-48 mx-auto" : "w-full"
    ]}>
        <div class:list={[
            "relative overflow-hidden z-10 h-full w-full",
            image ? "rounded-2xl border-4 border-white shadow-md" : "rounded-2xl"
        ]}>
            <slot name="image" />
        </div>
    </div>

    <div class:list={[
        "text-brand mb-6 relative z-10 empty:hidden",
        { "flex justify-center": centered }
    ]}>
        <slot name="icon"/>
    </div>

    <div class="relative z-10 w-full flex flex-col grow">
        <h3 class:list={[
            "h3 mb-1 transition-colors",
            { "group-hover:text-brand-hover": href }
        ]}>
            {title}
        </h3>

        <div class="card-text space-y-1 grow">
            <slot />
        </div>

        {href && (
                <div class="mt-6">
                    <slot name="link">
                        <div class="card-link">
                            Les mer <span class="ml-2 transition-transform group-hover:translate-x-1 inline-block">→</span>
                        </div>
                    </slot>
                </div>
        )}
    </div>

    <div class="card-progress-bar"></div>
</Tag>